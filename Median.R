library(RMySQL)

dir.create(paste("~/Temp_Graf_R/",sep=""),recursive = TRUE)

projects <- c("derby","tomcat","glibc","httpd","xen","kernel","mozilla")
metrics <- c("CountLineCode")

dataframe <- NULL

for(project in projects){
  con <- dbConnect(MySQL(), user = 'root', password = 'admin', host = 'localhost', dbname='software')
  vulnerable_query <- paste("SELECT * FROM software.FUNCTIONS_affected_",project,sep = "")
  neutral_query <- paste("SELECT * FROM software.FUNCTIONS_neutral_",project,sep = "")
  print(vulnerable_query)
  vulnerable_table_frame <- dbGetQuery(con,vulnerable_query)
  print(neutral_query)
  neutral_table_frame <- dbGetQuery(con,neutral_query)
  dbDisconnect(con)
  
  vulnerable_table_frame <- subset(vulnerable_table_frame, select = metrics)
  neutral_table_frame <- subset(neutral_table_frame, select = metrics)
  
  all <- rbind(vulnerable_table_frame,neutral_table_frame)
  long_method <- data.frame(all[all[,1]>100,])
  resumo <- summary(all)
  media <- resumo[3]
  mediana <- resumo[2]
  perc <- length(long_method[,1])/length(all[,1])

  dataframe <- rbind(dataframe, c(project,media,mediana,perc))
}

neutral_table_frame<-NULL
vulnerable_table_frame<-NULL
