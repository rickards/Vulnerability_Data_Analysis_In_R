library(RMySQL)
library(foreign)

path <- "~/EXPORTARFF/"
projects <- c("tomcat", "derby", "glibc", "httpd", "xen")

for(project in projects){
  con <- dbConnect(MySQL(), user = 'root', password = 'admin', host = '127.0.0.1', dbname='software')
  vulnerable_query <- paste("SELECT * FROM software.FUNCTIONS_affected_",project,sep = "")
  neutral_query <- paste("SELECT * FROM software.FUNCTIONS_neutral_",project,sep = "")
  print(vulnerable_query)
  vulnerable_table_frame <- dbGetQuery(con,vulnerable_query)
  print(neutral_query)
  neutral_table_frame <- dbGetQuery(con,neutral_query)
  dbDisconnect(con)
  
  all <- rbind(vulnerable_table_frame,neutral_table_frame)
  #all$CountDeclFunction <- all$CountDeclMethod
  #all$CountLinePreprocessor <- 0
  
  write.arff(all, paste(path,project,"_functions_unbalanced.arff",sep = ''))

}